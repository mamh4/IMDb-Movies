# Analysis

```{r, echo = FALSE, message = FALSE}
source(here::here("scripts/setup.R"))
```

## Studio Analysis

Earlier exploratory analysis showed that ratings have declined compared to the early days of Movies. This pattern still persists for all the Studios. We therefore turn our attention to analysing success with respect to gross. 
```{r out.width="800px"}
suppressWarnings({
  movies |> distinct(studio,year,title) |>
  group_by(year,studio) |>
  mutate(studio = if_else(studio %in% (movies |>
                                      distinct(studio, gross_CPI_adjusted) |>
                                      group_by(studio) |>
                                      summarise(gross_CPI_adjusted = sum(gross_CPI_adjusted, na.rm = TRUE)) |>
                                      arrange(desc(gross_CPI_adjusted)) |>
                                      filter(!is.na(studio)) |>
                                      slice(1:7) |>
                                      select(studio) |> unlist()), studio,"Other"))|>
  filter(!is.na(studio)) |>
  ggplot(aes(x=year, fill=factor(studio)))+
  geom_bar(position = "fill")+
  labs(title = "Other Studios Are Starting To Take More Market Share\nIn Terms of Movies Produced",
       subtitle = "Despite the relatively few movies produced by Buena Vista, it maintains spot of top\nGrossing Studios",
       y="Proportion of Movies Produced",
       fill = "Studio")+
  theme_minimal()

})

```


```{r}

movies |> distinct(studio,year,title,.keep_all = T) |>
  group_by(year,studio) |>
  mutate(studio = if_else(studio %in% (movies |>
                                        distinct(studio, year,gross_CPI_adjusted) |>
                                        group_by(studio) |>
                                        summarise(gross_CPI_adjusted = sum(gross_CPI_adjusted, na.rm = TRUE)) |>
                                        arrange(desc(gross_CPI_adjusted)) |>
                                        filter(!is.na(studio)) |>
                                        dplyr::slice(1:7) |>
                                        select(studio) |> unlist()), studio,"Other")) |>
  filter(!(is.na(studio)|is.na(gross_CPI_adjusted))) |>
  ggplot(aes(x=year, y=gross_CPI_adjusted , fill=factor(studio)))+
  geom_bar(stat = "identity",position = "fill")+
  labs(title = "The Big Studios still dominate in terms of Share of Gross"
         ,y="Proportion of Movies Gross",fill = "Studio") +
  theme_minimal()  



```
However, when paying attention to the amount of gross generated by studios we see that the major studios still have a huge market share in terms of gross.

Summary:
- Decline in Average Rating across all studios from Earlier in the day.
- Big Studios do not generate as many movies in proportion to relatively small ones however they are still producing successful movies when using gross as a metric





Now we break the model into impacts of Genre, Run time, .....nkdfjsdkfjlsdd√∂f



* Answers to the research questions
* Different methods considered
* Competing approaches
* Justifications

Here we analyse the variables we believe have an influence on movie success

## Genre - +geom_smooth()

* Genre

* Run-time (Attention span)

* Budget
Exclude all movies with budgets that are not US$.

* Certificate

* Studio

* Director

* Actor